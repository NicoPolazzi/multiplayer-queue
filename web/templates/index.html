{{ template "header.html" .}}

{{ if .ErrorTitle }}
<div class="alert alert-danger">
    <strong>{{ .ErrorTitle }}</strong>
    <p>{{ .ErrorMessage }}</p>
</div>
{{ end }}

{{ if .is_logged_in }}
<!-- Content for LOGGED-IN users -->
<h2>Welcome back, {{ .username }}!</h2>
<hr>
<h3>Available Lobbies</h3>

{{ if .lobbies }}
<table class="table table-striped">
    <thead>
        <tr>
            <th>Lobby Name</th>
            <th>Creator</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {{ range .lobbies }}
        <tr>
            <td>{{ .Name }}</td>
            <td>
                {{ if .Players }}
                {{ (index .Players 0).Username }}
                {{ else }}
                N/A
                {{ end }}
            </td>
            <td>
                <form action="/lobbies/{{.LobbyId}}/join" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-success btn-sm">Join</button>
                </form>
            </td>
        </tr>
        {{ end }}
    </tbody>
</table>
{{ else }}
<p>No available lobbies at the moment. Why not create one?</p>
{{ end }}

<hr>
<h3>Create a New Lobby</h3>
<form class="form-inline" action="/lobbies/create" method="POST">
    <div class="form-group">
        <label for="lobbyName" class="sr-only">Lobby Name</label>
        <input type="text" class="form-control" id="lobbyName" name="name" placeholder="My Lobby Name" required>
    </div>
    <button type="submit" class="btn btn-primary">Create Lobby</button>
</form>

{{ else }}
<!-- Content for GUESTS -->
<div class="jumbotron">
    <h1>Welcome to the Game Queue!</h1>
    <p>Please log in or register to join a lobby and start playing.</p>
    <p>
        <a class="btn btn-primary btn-lg" href="/user/login" role="button">Login</a>
        <a class="btn btn-success btn-lg" href="/user/register" role="button">Register</a>
    </p>
</div>
{{ end }}

{{ template "footer.html" .}}